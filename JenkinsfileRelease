pipeline{
    agent {label "windows"}
    stages{
        stage('hello'){
            steps{
                script{
                    withCredentials([usernamePassword(credentialsId: 'dockerhub', passwordVariable: 'DHUB_PASSWORD', usernameVariable: 'DHUB_USER')]) {
                    withEnv(['KUBECONFIG=c:\\azure\\azconfig']) {    
                    powershell label: '', script: '''
                    write-host $env:computername
                    cd samples/dotnetcore/getting-started/mywebapi
                    dir
                    kubectl config get-contexts
                    kubectl config use-context myAKSCluster
                    kubectl get namespaces
                    cd charts
                    helm upgrade webapi .
                    '''
                    }//withEnv
                    }//withcredentials
                }//script
            }//steps
        }//stage
    }//stages
}//stages